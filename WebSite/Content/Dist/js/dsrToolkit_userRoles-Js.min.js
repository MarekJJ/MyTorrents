angular.module("dsrUserRoles",["ui.router","datatables","datatables.bootstrap","dsrDataTables","ivh.treeview"]).config(["DefaultModuleStateProvider",function(e){e.initialize({entityName:"UserRole",templatesPath:"/Content/DSRToolkit/UserManagement/UserRoles/templates/",permissionRoot:"Administration/UserRoles/"})}]),angular.module("dsrUserRoles").factory("userRoleRemoveService",["genericRemoveService",function(e){return{remove:function(i){return e("/Administration/UserRoles/Remove","userRoles.removeConfirmationMessage").remove(i)}}}]),angular.module("dsrUserRoles").directive("treeViewCheckbox",[function(){return{restrict:"AE",template:['<span class="tree-view-checkbox noselect" ng-class="{\'disabled\': node.disabled}">','<span ng-show="node.selected" class="icheckbox_flat-green checked"></span>','<span ng-show="node.__ivhTreeviewIndeterminate" class="icheckbox_flat-green indeterminate"></span>','<span ng-hide="node.selected || node.__ivhTreeviewIndeterminate" class="icheckbox_flat-green"></span>',"</span>"].join(""),link:function(e,i,t){i.on("click",function(){e.$apply(function(){e.node.disabled||e.trvw.select(e.node,!e.node.selected)})})}}}]),angular.module("dsrUserRoles").directive("permissionTree",["ivhTreeviewMgr","ivhTreeviewBfs","$timeout",function(e,i,t){function s(e,t){var s=null;return i(e,function(e,i){return null===s&&(e.permissionId===t?(s=i[0],!1):void 0)}),s}function o(e){return _.find(e.children,function(e){return e.isAccessNode})}function n(i){if(i.ivhNode.permissionId){var t=s(i.ivhTree,i.ivhNode.permissionId);if(i.ivhNode.isAccessNode&&!i.ivhIsSelected)e.deselectEach(i.ivhTree,t.children);else if(!i.ivhNode.isAccessNode&&i.ivhIsSelected){var n=o(t);e.select(i.ivhTree,n)}}}return{scope:{data:"=",search:"="},template:['<div ivh-treeview="data" ng-if="show" ivh-treeview-options="treeOptions" ivh-treeview-validate="false" ivh-treeview-filter="search" class="noselect">','<script type="text/ng-template">','<div title="{{trvw.label(node)}}" ng-class="{\'disabled-node\': node.disabled}">',"<span ivh-treeview-toggle>","<span ivh-treeview-twistie></span>","</span>","<tree-view-checkbox></tree-view-checkbox> ",'<span class="ivh-treeview-node-label" ivh-treeview-toggle>','<span style="user-select:auto">{{ trvw.label(node) }}</span>',"</span>","<div ivh-treeview-children></div>","</div>","</script>","</div>"].join(""),link:function(e,i,s){e.treeOptions={expandToDepth:0,twistieCollapsedTpl:'<i class="fa fa-chevron-down" aria-hidden="true"></i>',twistieExpandedTpl:'<i class="fa fa-chevron-up"  aria-hidden="true"></i>',twistieLeafTpl:'<span style="width:13px; display:inline-block">&nbsp;</span>',onCbChange:n},t(function(){e.show=!0})}}}]),angular.module("dsrUserRoles").controller("AddOrUpdateUserRoleController",["$state","$stateParams","$translate","$http","toastrWrapper","userRoleRemoveService","ivhTreeviewMgr","ivhTreeviewBfs",function(e,i,t,s,o,n,r,a){function l(){s.post("/Administration/UserRoles/GetEditViewModel/"+(i.id||"")).then(function(e){var i=e.data;i.userRole&&(angular.extend(d.model,i.userRole),d.subtitle=i.userRole.name),d.permissionTree=i.permissionTreeData,r.validate(d.permissionTree,!1)})}var d=this;d.isEditMode="edit"===e.current.name,d.model={},d.save=function(){var e=[];a(d.permissionTree,function(i){i.selected&&i.permissionId&&e.push(i.permissionId)}),d.model.permissionIds=e,s.post("/Administration/UserRoles/AddOrUpdate",d.model).then(function(){o.showTranslatedSuccess("userRoles.savedSuccessfully"),d.goToListView()})},d.goToListView=function(){e.go("list")},d.remove=function(){n.remove(d.model.id).then(function(){d.goToListView()})},d.isEditMode||t("userRoles.addNewUserRole").then(function(e){d.subtitle=e}),l()}]),angular.module("dsrUserRoles").controller("PreviewUserRoleController",["$state","$stateParams","$http","userRoleRemoveService","ivhTreeviewMgr",function(e,i,t,s,o){var n=this;return n.model={},n.goToListView=function(){e.go("list")},n.goToEditView=function(){e.go("edit",{id:n.model.id})},n.remove=function(){s.remove(n.model.id).then(function(){n.goToListView()})},i.id?void t.post("/Administration/UserRoles/GetPreviewViewModel/"+i.id).then(function(e){angular.extend(n.model,e.data),o.validate(n.model.permissionTreeData,!1),n.subtitle=n.model.name}):void n.goToListView()}]),angular.module("dsrUserRoles").controller("UserRoleListController",["DTColumnBuilder","$translate","userRoleRemoveService",function(e,i,t){var s=this;s.options={tableDataUrl:"/Administration/UserRoles/GetList",columns:[e.newColumn("name").withTitle(i("common.name"))],permissions:{view:"Administration/UserRoles/View",edit:"Administration/UserRoles/Edit",delete:"Administration/UserRoles/Delete",add:"Administration/UserRoles/Add"},removeItems:function(e){return t.remove(e)}}}]);
//# sourceMappingURL=dsrToolkit_userRoles-Js.min.js.map
