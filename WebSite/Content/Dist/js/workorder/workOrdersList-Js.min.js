angular.module("sfcWorkOrdersList",["ui.router","datatables","datatables.bootstrap","dsrDataTables"]).config(["DefaultModuleStateProvider",function(r){r.initialize({entityName:"WorkOrder",templatesPath:"/Areas/WorkOrders/StaticViews/WorkOrders/",permissionRoot:"WorkOrders/WorkOrders/"})}]).run(["$rootScope","$translate",function(r,e){e("workorder.workOrderList").then(function(e){r.title=e})}]),angular.module("sfcWorkOrdersList").controller("AddOrUpdateWorkOrderController",["$scope","$state","$stateParams","$translate","$http","$q","toastrWrapper","confirmationService",function(r,e,t,o,n,i,a,d){function s(){var r=t.id||"";n.post("/WorkOrders/WorkOrders/GetEdit/"+r).then(function(r){var e=r.data.workOrder;angular.extend(u.model,e),u.parts=r.data.parts,u.workOrderStatuses=r.data.workOrderStatuses,u.routingStatuses=r.data.routingStatuses,u.sites=r.data.sites,u.workCenters=r.data.workCenters,u.machinesPerWorkCenter=r.data.machinesPerWorkCenter,e||(u.model.active=!0,u.model.routings=[])})}var u=this,l=1;return u.model={},u.isEditMode="edit"===e.current.name,u.reloadWorkCenters=function(){return n.post("/WorkOrders/WorkOrders/GetWorkCenters",{siteId:u.model.siteId}).then(function(r){u.workCenters=r.data,u.machinesPerWorkCenter={},angular.forEach(u.model.routings,function(r){r.workCenterId=null,r.machineId=null})})},u.reloadMachines=function(r){return n.post("/WorkOrders/WorkOrders/GetMachines",{workCenterId:r.workCenterId}).then(function(e){u.machinesPerWorkCenter[r.workCenterId]=e.data,r.machineId=null})},u.reloadPartNumberDropdown=function(r){return r?n.post("/WorkOrders/WorkOrders/GetPartNumbers",{search:r}).then(function(r){var e=[];$.each(r.data,function(r,t){var o=!1;$.each(u.rows,function(r,e){if(e.partNumber.id===t.value)return o=!0,!1}),o||e.push(t)}),u.parts=e}):i.resolve()},u.save=function(){var r=angular.copy(u.model);return n.post("/WorkOrders/WorkOrders/AddOrUpdate",r).then(function(){a.showTranslatedSuccess("workorder.savedSuccessfully"),u.goToListView()})},u.add=function(){var r={rowId:l++};u.model.routings.push(r)},u.goToListView=function(){e.go("list")},u.removeAt=function(r){u.model.routings[r].rowId;u.model.routings.splice(r,1)},u.checkUniqueOperation=function(r){var e=r.$error;e.uniqueOperationValidator&&e.uniqueOperationValidator.forEach(function(r,e,t){r.name!==name&&r.$validate()})},u.updateQty=function(){var r=u.model.qty;_.each(u.model.routingList,function(e,t,o){e.qty=r})},u.isEditMode&&!t.id?void u.goToListView():void s()}]),angular.module("sfcWorkOrdersList").controller("WorkOrderListController",["DTColumnBuilder","$translate","$filter","$scope","localStorageService","$window","BackendRootUrl",function(r,e,t,o,n,i,a){function d(r){o.orderIds=r,o.inDataType=1,i.location.href=a+"Statuses/RoutingStatusChange/#/"}var s=this;n.bind(o,"orderIds"),n.bind(o,"inDataType"),s.options={tableDataUrl:"/WorkOrders/WorkOrders/GetList",columns:[r.newColumn("number").withTitle(e("workorder.orderId")),r.newColumn("secondNumber").withTitle(e("workorder.orderNumber")),r.newColumn("workOrderStatus").withTitle(e("common.status")),r.newColumn("part").withTitle(e("part.name")),r.newColumn("qty").withTitle(e("common.quantity")),r.newColumn("releaseDate").withTitle(e("workorder.releaseDate")).renderWith(function(r,e,o){return t("formattedDate")(r)}),r.newColumn("dueDate").withTitle(e("workorder.dueDate")).renderWith(function(r,e,o){return t("formattedDate")(r)}),r.newColumn("priority").withTitle(e("workorder.priority")),r.newColumn("routingCount").withTitle(e("technology.operationCount")),r.newColumn("site").withTitle(e("common.site"))],permissions:{view:"WorkOrders/WorkOrders/View",edit:"WorkOrders/WorkOrders/Edit",delete:"",add:"WorkOrders/WorkOrders/Add"},additionalButtons:[{caption:"workorder.changeStatus",clickAction:d,functionSelected:"isAnyRowSelected",permission:"WorkOrders/WorkOrders/RoutingStatusChange"}]}}]),angular.module("sfcWorkOrdersList").controller("PreviewWorkOrderController",["$state","$stateParams","$http",function(r,e,t){var o=this;return o.model={},o.goToListView=function(){r.go("list")},o.goToEditView=function(){r.go("edit",{id:o.model.id})},e.id?void t.post("/WorkOrders/WorkOrders/Get/"+e.id).then(function(r){angular.extend(o.model,r.data),o.subtitle=o.model.orderID,o.elements=r.data.technologyList}):void o.goToListView()}]);
//# sourceMappingURL=workOrdersList-Js.min.js.map
