angular.module("dsrCommon",["datatables","ui.router","ui.bootstrap"]).config(["$httpProvider","$translateProvider","toastrConfig","uiSelectConfig","dynamicNumberStrategyProvider","CurrentLanguage","$provide",function(t,e,n,r,i,a,o){t.interceptors.push("progressIndicatorInterceptor"),t.interceptors.push("requestInterceptor"),t.interceptors.push("responseNotificationInterceptor"),t.interceptors.push("responseErrorInterceptor"),e.useStaticFilesLoader({prefix:"/Content/Dist/i18n/locale-",suffix:".json"}),e.useSanitizeValueStrategy("escape"),e.addInterpolation("$translateMessageFormatInterpolation"),e.preferredLanguage(a),r.theme="bootstrap",r.resetSearchInput=!0,r.appendToBody=!0,angular.extend(n,{positionClass:"toast-bottom-right"}),i.addStrategy("byte",{numThousand:!1,numInt:3,numFract:0,numNeg:!1}),i.addStrategy("integer",{numSep:".",numThousand:!1,numInt:10,numFract:0}),i.addStrategy("positive-integer",{numSep:".",numThousand:!1,numInt:10,numFract:0,numNeg:!1}),i.addStrategy("decimal",{numSep:".",numThousand:!1,numInt:10,numFract:8}),i.addStrategy("positive-decimal",{numSep:".",numThousand:!1,numInt:10,numFract:8,numNeg:!1}),i.addStrategy("small-decimal",{numSep:".",numThousand:!1,numInt:5,numFract:2}),i.addStrategy("positive-small-decimal",{numSep:".",numThousand:!1,numInt:5,numFract:2,numNeg:!1}),o.decorator("uibAccordionGroupDirective",["$delegate",function(t){var e=t[0];return e.templateUrl=function(t,e){return e.templateUrl||"./Content/DSRToolkit/Core/Scripts/Common/directives/templates/_accordionOverrideTemplate.html"},t}])}]).run(["$rootScope","$window","permissionService","datatablesConfigurationService","Permissions",function(t,e,n,r,i){t.$on("$stateChangeStart",function(t,e,r,i,a){_.isString(e.permission)&&!n.hasPermission(e.permission)&&t.preventDefault(),_.isArray(e.permission)&&!n.hasAnyPermission(e.permission)&&t.preventDefault()}),t.$on("$stateChangeSuccess",function(){e.scrollTo(0,0)}),n.setPermissions(i),r()}]),angular.module("dsrCommon").factory("permissionService",function(){var t=[];return{setPermissions:function(e){t=e},hasPermission:function(e){return _.contains(t,e)},hasAnyPermission:function(t){return _.any(t,this.hasPermission)}}}),angular.module("dsrCommon").factory("toastrWrapper",["toastr","$translate",function(t,e){function n(t){var e="<ul>";return angular.forEach(t,function(t,n){angular.isArray(t)&&t.length>0&&angular.forEach(t,function(t){e+="<li>"+t+"</li>"})}),e+="</ul>"}return{showNotification:function(e,n){var r="error"!==e?1500:0,i={closeButton:!0,extendedTimeOut:1e3,timeOut:r};t[e](n,i)},showError:function(e){t.error(e,{closeButton:!0,extendedTimeOut:1e3,timeOut:0})},showValidationError:function(e,r){var i=n(r);t.error(i,e,{closeButton:!0,extendedTimeOut:1e3,timeOut:0,allowHtml:!0})},showTranslatedNotification:function(t,n,r){var i=this;e(n,r).then(function(e){i.showNotification(t,e)})},showTranslatedWarning:function(t,e){this.showTranslatedNotification("warning",t,e)},showTranslatedError:function(t,e){this.showTranslatedNotification("error",t,e)},showTranslatedSuccess:function(t,e){this.showTranslatedNotification("success",t,e)},showTranslatedInfo:function(t,e){this.showTranslatedNotification("info",t,e)}}}]),angular.module("dsrCommon").factory("imageAttachmentUrlHelper",["BackendRootUrl",function(t){return{getImageUrl:function(e,n){return n?t+e+n:this.getPlaceholderUrl()},getPlaceholderUrl:function(){return t+"Content/DSRToolkit/Core/Images/no-image-placeholder.png"}}}]),angular.module("dsrCommon").factory("progressIndicatorService",["ngProgressFactory",function(t){function e(){return n++}var n=1,r=t.createInstance();r.setHeight("1px"),r.setColor("#1ABB9C");var i={};return{start:function(){var t=e();return _.isEmpty(i)&&r.start(),i[t]=!0,t},stop:function(t){delete i[t],_.isEmpty(i)&&r.complete()}}}]),angular.module("dsrCommon").factory("genericRemoveService",["$http","$translate","confirmationService",function(t,e,n){return function(r,i){function a(a,o){angular.isNumber(a)&&(a=[a]);var s=e(i,{COUNT:a.length},"messageformat"),l=o?e(o):null,u=l?n.showConfirmationWithWarning(s,l):n.showConfirmation(s);return u.result.then(function(){return t.post(r,{itemIds:a})})}return{remove:function(t){return a(t)},removeWithWarning:function(t,e){return a(t,e)}}}}]),angular.module("dsrCommon").provider("DefaultModuleState",["$stateProvider","$urlRouterProvider",function(t,e){this.initialize=function(n,r){t.state({name:"list",url:"/",templateUrl:n.templatesPath+"_list.html",controller:n.entityName+"ListController as $ctrl"}),t.state({name:"add",url:"/add",templateUrl:n.templatesPath+"_addOrUpdate.html",controller:"AddOrUpdate"+n.entityName+"Controller as $ctrl",permission:n.permissionRoot+"Add"}),t.state({name:"edit",url:"/edit/{id}",templateUrl:n.templatesPath+"_addOrUpdate.html",controller:"AddOrUpdate"+n.entityName+"Controller as $ctrl",permission:n.permissionRoot+"Edit",params:{id:""}}),t.state({name:"preview",url:"/preview/{id}",templateUrl:n.templatesPath+"_preview.html",controller:"Preview"+n.entityName+"Controller as $ctrl",permission:n.permissionRoot+(n.previewPermission||"View"),params:{id:""}}),r&&$.each(r,function(e,n){t.state(n)}),e.otherwise("/")},this.$get=function(){return{initialize:this.initialize}}}]),angular.module("dsrCommon").factory("waitFor",["$timeout",function(t){function e(n,r){return n()?r():t(function(){return e(n,r)},100)}return e}]),angular.module("dsrCommon").directive("hasPermission",["permissionService",function(t){return{link:function(e,n,r){if(!_.isString(r.hasPermission))throw"hasPermission value must be a string";var i=r.hasPermission.trim(),a="!"===i[0];a&&(i=i.slice(1).trim());var o=t.hasPermission(i);o&&!a||!o&&a?n.show():n.hide()}}}]),angular.module("dsrCommon").directive("readonlyCheckbox",function(){return{template:'<div class="icheckbox_flat-green disabled"></div>',link:function(t,e,n){var r="true"===n.checked;e.children().toggleClass("checked",r)}}}).directive("icheck",["$timeout","$parse",function(t,e){return{restrict:"A",require:"ngModel",link:function(e,n,r,i){t(function(){function a(t){"radio"===r.type?i.$setViewValue(o):i.$setViewValue(t)}var o=r.value;n.iCheck({checkboxClass:r.checkboxClass||"icheckbox_flat-green",radioClass:r.radioClass||"iradio_flat-green"}).on("ifChanged",function(n){t(function(){e.$apply(function(){a(n.target.checked)}),e.$apply(r.ngClick)})}),e.$watch(function(){return r.ngChecked},function(t){"undefined"==typeof t&&(t=!!i.$viewValue),a(t)},!0),e.$watch(r.ngModel,function(t){n.iCheck("update")},!0),e.$watch(r.ngDisabled,function(t){n.iCheck("update")}),e.$watch(function(){return i.$touched&&i.$invalid},function(t){n.parent().toggleClass("invalid",t)}),e.$on("$destroy",function(){n.iCheck("destroy")})})}}}]),angular.module("dsrCommon").directive("viewHeader",[function(){return{restrict:"E",transclude:!0,templateUrl:"./Content/DSRToolkit/Core/Scripts/Common/directives/templates/_viewHeaderTemplate.html",scope:{title:"@",subtitle:"@"}}}]),angular.module("dsrCommon").directive("formGroup",[function(){return{restrict:"E",template:' <div class="{{formGroupClass}}"><label class="{{labelClass}} control-label">{{ label }}:<span ng-if="isRequired" class="required-field-marker">*</span></label><div class="{{contentClass}}"><ng-transclude /></div></div>',transclude:!0,scope:{label:"@",isRequired:"<"},link:function(t,e,n){t.labelClass="col-sm-3 col-xs-12",void 0!==n.labelClass&&(t.labelClass=n.labelClass),t.contentClass="col-sm-8 col-lg-6 col-xs-12",void 0!==n.contentClass&&(t.contentClass=n.contentClass),t.formGroupClass="form-group",void 0!==n.formGroupClass&&(t.formGroupClass=n.formGroupClass)}}}]),angular.module("dsrCommon").service("formValidationHelper",function(){function t(e){angular.forEach(e.$error,function(e){angular.forEach(e,function(e){void 0!==e.$submitted?t(e):e.$setTouched()})})}return{markFormAsTouched:t}}).directive("formSubmitOnEnter",["formValidationHelper",function(t){return{scope:{submitAction:"&formSubmitOnEnter",form:"<"},link:function(e,n,r){n.on("keypress",function(n){13===n.which&&(n.preventDefault(),e.$apply(function(){e.form.$invalid?t.markFormAsTouched(e.form):e.submitAction()}))})}}}]).directive("formSubmitButton",["$timeout","formValidationHelper",function(t,e){return{scope:{submitAction:"&formSubmitButton",form:"<"},link:function(n,r,i){r.on("click",function(){t(function(){n.form.$invalid?e.markFormAsTouched(n.form):n.submitAction()})})}}}]),angular.module("dsrCommon").directive("backButton",["$window","$state",function(t,e){return{restrict:"A",link:function(n,r,i){r.on("click",function(){t.history.length>1?t.history.back():i.backButton&&e.go(i.backButton)})}}}]),angular.module("dsrCommon").component("defaultListView",{bindings:{title:"@",options:"="},templateUrl:"./Content/DSRToolkit/Core/Scripts/Common/directives/templates/_defaultListViewTemplate.html",controllerAs:"defaultListViewCtrl",controller:["DTOptionsBuilder","DTColumnBuilder","$state","genericDataTableAjaxProvider","dataTableHelper","permissionService","$timeout","$scope",function(t,e,n,r,i,a,o,s){function l(t){return e.newColumn(t).withTitle(d).notSortable().withClass("select-checkbox").renderWith(function(e,n,r,i){var a=r[t];return u.table.selected[a]=!1,"<input ng-model=\"defaultListViewCtrl.table.selected['"+a+'\']" ng-click="defaultListViewCtrl.table.checkIfAllSelected()" type="checkbox" icheck />'})}var u=this;u.dataTableInstance={},u.table=i.prepareModelForTable(),u.rowsData=[],u.firstTimeTableFixer=!1;var c=u.options.modelId||"id",d='<input ng-model="defaultListViewCtrl.table.selectAll" ng-click="defaultListViewCtrl.table.toggleAll()" type="checkbox" icheck  />';u.dtOptions=t.newOptions().withOption("ajax",r(u.options.tableDataUrl)).withDataProp("data").withOption("paging",!0).withOption("stateSave",!0).withOption("stateDuration",-1).withOption("processing",!0).withOption("serverSide",!0).withOption("preDrawCallback",function(t){var e=this.api();!u.firstTimeTableFixer&&t._iRecordsTotal>0&&0===e.rows().count()&&(u.firstTimeTableFixer=!0,e.page("first").state.save(),o(e.ajax.reload))}).withOption("createdRow",function(t,e,n){var r=angular.element(t);r.attr("ng-class",'{"selected" : defaultListViewCtrl.table.selected[\''+e[c]+"']}"),r.attr("ng-click","defaultListViewCtrl.table.toggleOne('"+e[c]+"')"),r.attr("ng-dblclick","defaultListViewCtrl.goToDetails('"+e[c]+"')"),u.rowsData[n]=e}).withPaginationType("full_numbers").withBootstrap(),u.options.columns.splice(0,0,l(c)),u.dtColumns=u.options.columns,u.goToAddItemView=function(){n.go("add")},u.goToPreviewView=function(t){var e=t||u.table.getSelectedItemIds()[0];n.go("preview",{id:e})},u.goToEditView=function(t){var e=t||u.table.getSelectedItemIds()[0];n.go("edit",{id:e})},u.goToDetails=function(t){a.hasPermission(u.options.permissions.edit)?u.goToEditView(t):a.hasPermission(u.options.permissions.view)&&u.goToPreviewView(t)},u.removeSelectedItems=function(){var t=u.table.getSelectedItemIds();u.options.removeItems(t).then(function(){u.dataTableInstance.reloadData()})},s.$on("event:reload-datatable",function(){u.dataTableInstance.reloadData()})}]}),angular.module("dsrCommon").directive("uiSelectMultipleFocusFix",function(){return{restrict:"A",require:"uiSelect",link:function(t,e,n,r){var i=r.searchInput;i.on("focus",function(){e.addClass("focus")}),i.on("blur",function(){e.removeClass("focus")}),t.$on("$destroy",function(){i.off("focus"),i.off("blur")})}}}),angular.module("dsrCommon").directive("timePicker",["$timeout","$translate","durationHelper","$log",function(t,e,n,r){function i(t,e){this.value=0,this.maxValue=t,this.step=e||1,this.increment=function(){var t=this.value+this.step;t-=t%this.step,this.value=t<=this.maxValue?t:0},this.decrement=function(){if(this.value>0){var t=this.value%this.step,e=t>0?this.value-t:this.value-this.step;this.value=Math.max(0,e)}else this.value=this.maxValue+1-this.step}}return{templateUrl:"./Content/DSRToolkit/Core/Scripts/Common/directives/templates/timePicker.template.html",scope:{timeValue:"="},link:function(e,n,a){r.warn("timePicker directive is depreciated, please use dsrTimePicker with ng-model instead.");var o=n.find("input[type=text]");o.on("focus",function(){e.$apply(function(){e.isOpen=!0,t(function(){n.find(".popover-content input:first").focus()},100)})}),n.find(".input-group-addon").on("click",function(){o.focus()}),e.onKeyUp=function(t,e,n){38===t.keyCode?e.increment():40===t.keyCode&&e.decrement()},e.closeOnTabPress=function(t){9===t.keyCode&&(e.isOpen=!1)},e.hide=function(){e.isOpen=!1},e.hours=new i(23),e.minutes=new i(59,15);var s=60;e.$watchGroup(["hours.value","minutes.value"],function(t){var n=e.hours.value*s+e.minutes.value;e.textInputValue=moment(0).hours(0).minutes(n).format("HH:mm"),e.timeValue=n}),e.$watch("timeValue",function(t,n){if(void 0!==t&&!isNaN(t)){var r=moment.duration(t,"minutes");e.hours.value=r.hours(),e.minutes.value=r.minutes()}}),e.onChange=function(t,e){t.value=Math.min(t.value,e)}}}}]).directive("dsrTimePicker",["$timeout",function(t){function e(t,e){this.value=0,this.maxValue=t,this.step=e||1,this.increment=function(){var t=this.value+this.step;t-=t%this.step,this.value=t<=this.maxValue?t:0},this.decrement=function(){if(this.value>0){var t=this.value%this.step,e=t>0?this.value-t:this.value-this.step;this.value=Math.max(0,e)}else this.value=this.maxValue+1-this.step}}return{restrict:"E",templateUrl:"./Content/DSRToolkit/Core/Scripts/Common/directives/templates/dsrTimePicker.template.html",require:"ngModel",replace:!0,link:function(n,r,i,a){var o=r.find("input[type=text]");n.hours=new e(23),n.minutes=new e(59,15),n.ngModelCtrl=a,o.on("focus",function(){n.$apply(function(){n.isOpen=!0,a.$setTouched(),t(function(){r.find(".popover-content input:first").focus()},100)})}),r.find(".input-group-addon").on("click",function(){o.focus()}),n.onKeyUp=function(t,e,n){38===t.keyCode?e.increment():40===t.keyCode&&e.decrement()},n.closeOnTabPress=function(t){9===t.keyCode&&(n.isOpen=!1)},n.hide=function(){n.isOpen=!1},a.$formatters.push(function(t){if(void 0!==t&&!isNaN(t)){var e=moment.duration(t,"minutes");return{hours:e.hours(),minutes:e.minutes()}}}),a.$render=function(){a.$viewValue&&(n.hours.value=a.$viewValue.hours,n.minutes.value=a.$viewValue.minutes,n.textInputValue=moment(0).hours(n.hours.value).minutes(n.minutes.value).format("HH:mm"))},a.$parsers.push(function(t){var e=t.hours,n=t.minutes;return 60*e+n}),n.$watchGroup(["hours.value","minutes.value"],function(t){a.$setViewValue({hours:Math.min(parseInt(t[0]),23),minutes:Math.min(parseInt(t[1]),59)}),a.$render()})}}}]).directive("datePicker",["CurrentLanguage","GlobalConfiguration",function(t,e){return{templateUrl:"./Content/DSRToolkit/Core/Scripts/Common/directives/templates/_datePickerTemplate.html",require:"^^form",scope:{name:"@",model:"=",field:"@",required:"=",type:"@",placeholder:"@",disabled:"="},link:function(n,r,i,a){n.formCtrl=a,n.dateFieldOptions={allowInputToggle:!0,locale:t,format:"dateTime"===n.type?e.dateTimeFormat:e.dateFormat},n.show=!0}}}]),angular.module("dsrCommon").directive("dateTimeFormatter",["$filter",function(t){var e=t("formattedDateTime");return{require:"ngModel",link:function(t,n,r,i){i.$formatters.push(function(t){return e(t)})}}}]),angular.module("dsrCommon").component("attachmentPanel",{templateUrl:"./Content/DSRToolkit/Core/Scripts/Common/directives/templates/_attachmentPanel.template.html",bindings:{attachments:"=",options:"<",readonly:"<"},controller:["$translate","$http","confirmationService","imageAttachmentUrlHelper","Upload","toastrWrapper",function(t,e,n,r,i,a){function o(){return angular.isFunction(s.options.uploadData)?s.options.uploadData():s.options.uploadData}var s=this;s.baseUrl="Attachments/"+s.options.categoryName,s.getFileAccessUrl=function(t){return r.getImageUrl(s.baseUrl+"/GetFileAttachment/",t)},s.removeFile=function(r){var i=t("requests.attachmentRemoveConfirmationMessage",{COUNT:1},"messageformat"),a=s.attachments[r];return n.showConfirmation(i).result.then(function(){var t=angular.extend({id:a.id},o());return e.post(s.baseUrl+"/RemoveFileAttachment",t).then(function(t){s.attachments.splice(r,1)})})},s.uploadFile=function(){var t=s.newAttachment,e={url:s.baseUrl+"/UploadFileAttachment",data:angular.extend({file:t},o())};i.upload(e).then(function(t){s.attachments.push(t.data),s.newAttachment=null},function(t){t.status>0&&403!==t.status&&a.showError(t.status+": "+t.data)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]}),angular.module("dsrCommon").component("imageAttachmentPanel",{templateUrl:"./Content/DSRToolkit/Core/Scripts/Common/directives/templates/imageAttachmentPanel.template.html",bindings:{imageAttachmentId:"=",options:"<",readonly:"<"},controller:["$scope","imageAttachmentUrlHelper","Upload","toastrWrapper",function(t,e,n,r){function i(t){var n="Attachments/"+o.options.categoryName+"/GetFileAttachment/";return e.getImageUrl(n,t)}function a(){return angular.isFunction(o.options.uploadData)?o.options.uploadData():o.options.uploadData}var o=this;t.$watch(function(){return o.imageAttachmentId},function(t){angular.isUndefined(t)||(o.imageUrl=i(t))}),o.uploadImage=function(){var t=o.imageFile,e="Attachments/"+o.options.categoryName+"/UploadImageAttachment",s=angular.extend({file:t},a());n.upload({url:e,data:s}).then(function(t){o.imageAttachmentId=t.data.id,o.imageUrl=i(o.imageAttachmentId),o.imageFile=null},function(t){t.status>0&&r.showError(t.status+": "+t.data)},function(e){t.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}]}),angular.module("dsrCommon").component("linkList",{bindings:{items:"<",options:"<"},template:['<div ng-repeat="item in $ctrl.items track by $index">','<span ng-if="$ctrl.hasAnyRequiredPermission"><a ng-href="{{$ctrl.getLinkUrl(item)}}" class ="link">{{ item.name }}</a></span>','<span ng-if="!$ctrl.hasAnyRequiredPermission">{{ item.name }}</span>',"</div>"].join(""),controller:["BackendRootUrl","permissionService",function(t,e){function n(t){return e.hasPermission(t.permission)}var r=this;if(r.hasAnyRequiredPermission=_.any(r.options,n),r.hasAnyRequiredPermission){var i=_.find(r.options,n);r.linkUrlBase=t+i.linkUrl}r.getLinkUrl=function(t){return r.linkUrlBase+t.id}}]}),angular.module("dsrCommon").directive("revalidateOn",[function(){return{restrict:"A",require:"ngModel",link:function(t,e,n,r){function i(e){t.$on(e,function(){r.$validate()})}var a=n.revalidateOn.split(",");angular.forEach(a,function(t){i(t)})}}}]).directive("maxValue",["$parse",function(t){return{restrict:"A",require:"ngModel",link:function(e,n,r,i){i.$validators.maxValue=function(n){if(!_.isNumber(n)||_.isNaN(n))return i.$viewValue=null,i.$render(),!0;var a=t(r.maxValue)(e);return n<=a}}}}]).directive("maxValueOrNull",["$parse",function(t){return{restrict:"A",require:"ngModel",link:function(e,n,r,i){i.$validators.maxValueOrNull=function(n){if(!_.isNumber(n)||_.isNaN(n))return i.$viewValue=null,i.$render(),!0;var a=t(r.maxValueOrNull)(e);return!(_.isNumber(a)&&!_.isNaN(a))||n<=a}}}}]).directive("minValue",["$parse",function(t){return{restrict:"A",require:"ngModel",link:function(e,n,r,i){i.$validators.minValue=function(n){if(!_.isNumber(n)||_.isNaN(n))return i.$viewValue=null,i.$render(),!0;var a=t(r.minValue)(e);return n>=a}}}}]).directive("minValueOrNull",["$parse",function(t){return{restrict:"A",require:"ngModel",link:function(e,n,r,i){i.$validators.minValueOrNull=function(n){if(!_.isNumber(n)||_.isNaN(n))return i.$viewValue=null,i.$render(),!0;var a=t(r.minValueOrNull)(e);return!(_.isNumber(a)&&!_.isNaN(a))||n>=a}}}}]).directive("greaterThanZero",["$parse",function(t){return{restrict:"A",require:"ngModel",link:function(t,e,n,r){r.$validators.greaterThanZero=function(t){return!_.isNumber(t)||_.isNaN(t)?(r.$viewValue=null,r.$render(),!0):t>0}}}}]).directive("maxDecimalDigits",["$parse",function(t){return{restrict:"A",require:"ngModel",link:function(e,n,r,i){function a(t){var e=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return e?Math.max(0,(e[1]?e[1].length:0)-(e[2]?+e[2]:0)):0}i.$validators.maxDecimalDigits=function(n){if(!_.isNumber(n)||_.isNaN(n))return i.$viewValue=null,i.$render(),!0;var o=t(r.maxDecimalDigits)(e);return!(_.isNumber(o)&&!_.isNaN(o))||a(n)<=o}}}}]).directive("isActiveSelectListItem",[function(){return{restrict:"A",require:"ngModel",link:function(t,e,n,r){r.$validators.isActiveSelectListItem=function(e){var r=t.$eval(n.selectListItems),i=_.find(r,function(t){return t.value==e}),a=!i||i.active;return a}}}}]),angular.module("dsrCommon").directive("uniqueAsyncValidator",["$q","$http","$state",function(t,e,n){return{restrict:"A",require:"ngModel",link:function(n,r,i,a){a.$asyncValidators.uniqueAsyncValidator=function(r){if(!a.$dirty)return t.resolve();var o=n.$eval(i.modelId),s=i.uniqueAsyncValidator;return e.post(s,{id:o,value:r}).then(function(e){return e.data===!0?t.resolve():t.reject()})}}}}]).directive("uniqueAsyncValidatorWithData",["$q","$http","$state",function(t,e,n){return{restrict:"A",require:"ngModel",link:function(n,r,i,a){a.$asyncValidators.uniqueAsyncValidatorWithData=function(r){if(!a.$dirty)return t.resolve();var o=n.$eval(i.validatorData);if(void 0!==o.ready&&!o.ready)return t.resolve();var s=i.uniqueAsyncValidatorWithData,l=angular.extend({value:r},o.data);return e.post(s,l).then(function(e){(o.callback||angular.noop)(e.data);var n=_.isBoolean(e.data)?e.data:e.data.isValid;return n===!0?t.resolve():t.reject()})}}}}]).directive("uniqueWithParentAsyncValidator",["$q","$http",function(t,e){return{restrict:"A",require:"ngModel",link:function(n,r,i,a){a.$asyncValidators.uniqueWithParentAsyncValidator=function(r){var a=n.$eval(i.modelId),o=n.$eval(i.modelParentId),s=i.uniqueWithParentAsyncValidator;return e.post(s,{id:a,parentId:o,value:r}).then(function(e){return e.data===!0?t.resolve():t.reject()})}}}}]),angular.module("dsrCommon").factory("requestInterceptor",["$templateCache","BackendRootUrl",function(t,e){function n(t){var e=t.indexOf("?")===-1?"?":"&";return t+e+"v="+(new Date).getTime()}return{request:function(r){var i="GET"===r.method&&void 0!==t.get(r.url);if(!i){var a=e+r.url;a=a.replace("//","/"),r.url=n(a)}return r.headers["X-Requested-With"]="XMLHttpRequest",r}}}]),angular.module("dsrCommon").factory("responseNotificationInterceptor",["$injector",function(t){return{response:function(e){if(e.headers("notification-response")){var n=t.get("toastrWrapper");n.showNotification(e.data.notificationType,e.data.message)}return e}}}]),angular.module("dsrCommon").factory("responseErrorInterceptor",["$q","$window","$injector",function(t,e,n){return{responseError:function(r){var i=n.get("toastrWrapper");return 401===r.status?e.location.reload():403===r.status?i.showTranslatedError("common.accessForbidden"):404===r.status?i.showTranslatedError("common.notFoundProblem",{url:r.config.url}):r.data&&void 0!==!r.data.message?r.data.validationData?i.showValidationError(r.data.message,r.data.validationData):r.data.isMessageKey?i.showTranslatedError(r.data.message):i.showError(r.data.message):i.showTranslatedError("common.serverResponseProblem"),t.reject(r)}}}]),angular.module("dsrCommon").factory("progressIndicatorInterceptor",["$injector","$q",function(t,e){return{request:function(e){return e.progressActionId=t.get("progressIndicatorService").start(),e},response:function(e){return t.get("progressIndicatorService").stop(e.config.progressActionId),e},responseError:function(n){return t.get("progressIndicatorService").stop(n.config.progressActionId),e.reject(n)}}}]),angular.module("dsrCommon").filter("formattedDate",["GlobalConfiguration",function(t){return function(e){return e?moment(e).format(t.dateFormat):""}}]),angular.module("dsrCommon").filter("formattedDateTime",["GlobalConfiguration",function(t){return function(e){return e?moment(e).format(t.dateTimeFormat):""}}]).filter("formattedDateTimeWithSeconds",["GlobalConfiguration",function(t){return function(e){return e?moment(e).format(t.dateTimeWithSecondsFormat):""}}]),angular.module("dsrCommon").filter("hasPermission",["permissionService",function(t){return function(e){var n=t.hasPermission(e);return n}}]),angular.module("dsrCommon").filter("parenthesesWrapper",function(){return function(t){return t?"("+t+")":t}}),angular.module("dsrCommon").filter("minutesToFormattedTime",["GlobalConfiguration",function(t){return function(t){return _.isNumber(t)?moment(0).hours(0).minutes(t).format("HH:mm"):"-"}}]).filter("durationInSecondsToFormattedTime",["leadingZerosFilter",function(t){return function(e){if(_.isNumber(e)){var n=Math.floor(e/60),r=Math.floor(n/60),i=n%60;return t(r,2)+":"+t(i,2)}}}]).filter("leadingZeros",[function(){return function(t,e){for(var n=String(t);n.length<(e||2);)n="0"+n;return n}}]),angular.module("dsrDuration",["pascalprecht.translate"]),angular.module("dsrDuration").factory("durationHelper",["$translate",function(t){return{hoursToString:function(e){var n=Math.floor(e/24),r=e%24;return[n,t.instant("common.duration.days"),r,t.instant("common.duration.hours")].join(" ")},minutesToString:function(e){var n=Math.floor(e/60),r=e%60;return[n,t.instant("common.duration.hours"),r,t.instant("common.duration.minutes")].join(" ")}}}]),angular.module("dsrDuration").directive("durationLabel",["durationHelper",function(t){var e={minutes:t.minutesToString,hours:t.hoursToString};return{restrict:"A",scope:{value:"<durationLabel",unit:"@durationUnit"},link:function(t,n,r){function i(){var r=e[t.unit](t.value);n.text(r)}i(),t.$watch("value",function(){i()})}}}]),angular.module("dsrDuration").directive("durationPicker",["$timeout","$translate","durationHelper",function(t,e,n){function r(t){this.value=0,this.step=t||1,this.increment=function(){var t=this.value+this.step;this.value=t-t%this.step},this.decrement=function(){if(this.value>0){var t=this.value%this.step,e=t>0?this.value-t:this.value-this.step;this.value=Math.max(0,e)}}}return{templateUrl:"/Content/DSRToolkit/Core/Scripts/Duration/templates/_durationPickerTemplate.html",scope:{durationValue:"=",durationUnit:"@",durationStep:"@"},link:function(i,a,o){var s=a.find("input[type=text]");s.on("focus",function(){i.$apply(function(){i.isOpen=!0,t(function(){a.find(".popover-content input:first").focus()},100)})}),a.find(".input-group-addon").on("click",function(){s.focus()}),i.onKeyUp=function(t,e,n){38===t.keyCode?e.increment():40===t.keyCode&&e.decrement()},i.closeOnTabPress=function(t){9===t.keyCode&&(i.isOpen=!1)},i.hide=function(){i.isOpen=!1};var l="minutes"===i.durationUnit;i.value1=new r,i.value2=new r(parseInt(i.durationStep)),i.value1Label=e.instant(l?"common.duration.hours":"common.duration.days"),i.value2Label=e.instant(l?"common.duration.minutes":"common.duration.hours");var u=l?60:24,c=l?n.minutesToString:n.hoursToString;i.$watchGroup(["value1.value","value2.value"],function(t){var e=i.value1.value*u+i.value2.value;i.textInputValue=c(e),i.durationValue=e}),i.$watch("durationValue",function(t,e){void 0===t||isNaN(t)||(i.value1.value=Math.floor(t/u),i.value2.value=t%u)})}}}]),angular.module("dsrConfirmation",["ui.bootstrap","pascalprecht.translate"]),angular.module("dsrConfirmation").factory("confirmationService",["$uibModal","$translate",function(t,e){function n(e,n){return t.open({component:"confirmationModalComponent",resolve:{confirmationMessage:function(){return e},warningMessage:function(){return n}}})}return{showConfirmation:function(t){return n(t)},showConfirmationWithWarning:function(t,e){return n(t,e)},showTranslatedConfirmation:function(t){return n(e(t))}}}]),angular.module("dsrConfirmation").component("confirmationModalComponent",{templateUrl:"/Content/DSRToolkit/Core/Scripts/Confirmation/templates/confirmationModalComponent.template.html",bindings:{resolve:"<",close:"&",dismiss:"&"},controller:function(){var t=this;t.$onInit=function(){t.confirmationMessage=t.resolve.confirmationMessage,t.warningMessage=t.resolve.warningMessage}}}),angular.module("dsrDataTables",["datatables","datatables.bootstrap","toastr"]),angular.module("dsrDataTables").factory("genericDataTableAjaxProvider",["$http","toastrWrapper",function(t,e){var n=function(t){t({recordsTotal:0,recordsFilterd:0,data:[]})};return function(r){return function(i,a,o){t.post(r,i).then(function(t){t.data.error?(n(a),e.showError(t.data.error)):a(t.data)},function(){n(a)})}}}]),angular.module("dsrDataTables").factory("dataTableHelper",function(){function t(){var t=this;_.each(_.keys(this.selected),function(e){t.selected[e]=t.selectAll})}function e(t){this.selected[t]=!this.selected[t],this.checkIfAllSelected()}function n(){return!0}function r(){return!1}function i(){this.selectAll=this.allRowSelected()}function a(){return _.some(_.values(this.selected))}function o(){return _.all(_.values(this.selected))}function s(){var t=this.getSelectedItemIds();return 1===t.length}function l(t){var e=this[t];if(!e){var n={name:"Bad name exception",message:"The name "+t+" is not a member of dataTableHelper module. Check the code and use proper name."};throw n}return e.call(this)}function u(){var t=this,e=[];return _.each(_.keys(this.selected),function(n){t.selected[n]===!0&&e.push(n)}),e}function c(){this.selected={},this.selectAll=!1,this.toggleAll()}function d(){return{selected:{},selectAll:!1,toggleAll:t,toggleOne:_.throttle(e,300),checkIfAllSelected:i,isAnyRowSelected:a,allRowSelected:o,onlyOneSelected:s,getSelectedItemIds:u,getFunctionSelected:l,clear:c,whateverFalse:r,whateverTrue:n}}return{prepareModelForTable:d}}),angular.module("dsrDataTables").factory("datatablesConfigurationService",["DTDefaultOptions","BackendRootUrl","CurrentLanguage",function(t,e,n){return function(){t.setLanguage({url:e+"Content/Vendor/datatables/i18n/"+n+".json"})}}]),angular.module("dsrDataTables").directive("datatablesBindAngularFix",["$compile","$timeout",function(t,e){return{restrict:"A",link:function(n,r,i){function a(){null!==s&&(s.$destroy(),s=null,i.preDrawCallback&&e(function(){n.$apply(i.preDrawCallback)}))}function o(){s=n.$new(),t(r.find("thead"))(s),t(r.find("tbody"))(s)}var s=null;r.on("preDraw.dt",a).on("draw.dt",o)}}}]),angular.module("dsrDataTables").directive("datatablesProcessingIndicator",function(){return{restrict:"A",link:function(t,e){e.on("processing.dt",function(t,e,n){if(n){var r=angular.element(e.nTableWrapper).find(".dataTables_processing");r.css("color","gray"),r.html('<i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>')}})}}}),angular.module("dsrDataTables").component("datatable",{template:'<table id="def" datatable="" dt-options="$dataTableCtrl.dtOptions" dt-columns="$dataTableCtrl.dtColumns" dt-instance="$dataTableCtrl.dataTableInstance" datatables-bind-angular-fix pre-draw-callback="$dataTableCtrl.options.table.clear()" datatables-processing-indicator class="table stylized-table"></table>',bindings:{options:"="},controllerAs:"$dataTableCtrl",controller:["DTOptionsBuilder","DTColumnBuilder","genericDataTableAjaxProvider","dataTableHelper",function(t,e,n,r){function i(t){return e.newColumn(t).withTitle(s).notSortable().withClass("select-checkbox").renderWith(function(e,n,r,i){var o=r[t];return a.options.table.selected[o]=!1,"<input ng-model=\"$dataTableCtrl.options.table.selected['"+o+'\']" ng-click="$dataTableCtrl.options.table.checkIfAllSelected()" type="checkbox" icheck />'})}var a=this;a.dataTableInstance={},a.options.table=r.prepareModelForTable(),a.rowsData=[];var o=a.options.modelId||"id",s='<input ng-model="$dataTableCtrl.options.table.selectAll" ng-click="$dataTableCtrl.options.table.toggleAll()" type="checkbox" icheck  />';a.dtOptions=t.newOptions().withOption("ajax",n(a.options.tableDataUrl)).withDataProp("data").withOption("paging",!0).withOption("stateSave",!0).withOption("stateDuration",-1).withOption("processing",!0).withOption("serverSide",!0).withOption("createdRow",function(t,e,n){var r=angular.element(t);r.attr("ng-class",'{"selected" : $dataTableCtrl.options.table.selected[\''+e[o]+"']}"),r.attr("ng-click","$dataTableCtrl.options.table.toggleOne('"+e[o]+"')"),r.attr("ng-dblclick","$dataTableCtrl.options.goToDetails('"+e[o]+"')"),a.rowsData[n]=e;
}).withPaginationType("full_numbers").withBootstrap(),a.options.columns.splice(0,0,i(o)),a.dtColumns=a.options.columns}]}),angular.module("dsrLayout",["ngCookies"]),angular.module("dsrLayout").directive("menuToggle",["$cookies",function(t){return{restrict:"EA",transclude:!0,link:function(e,n,r,i,a){var o=$("body"),s=$("#sidebarMenu");n.append(a()),n.on("click",function(){o.hasClass("nav-md")?(s.find("li.active ul").hide(),s.find("li.active").addClass("active-sm").removeClass("active")):(s.find("li.active-sm > ul").show(),s.find("li.active-sm").addClass("active").removeClass("active-sm")),o.toggleClass("nav-md nav-sm");var e=o.hasClass("nav-md")?"nav-md":"nav-sm";t.put("dsr.menu-size",e,{path:"/"})})}}}]),angular.module("dsrLayout").directive("sidebarMenu",["$http","$timeout",function(t,e){return{restrict:"EA",transclude:!0,link:function(n,r,i,a,o){function s(){r.find("a").on("click",function(){var t=$(this).parent();t.is(".active")?(t.removeClass("active active-sm"),t.find("ul:first").slideUp()):(t.parent().is(".child_menu")||(r.find("li").removeClass("active active-sm"),r.find("li ul").slideUp()),t.addClass("active"),t.find("ul:first").slideDown())})}r.append(o()),s(),n.$root.$on("reload-menu",function(n){e(function(){t.get("/Home/Menu").then(function(t){r.empty().html(t.data),s()})})})}}}]);
//# sourceMappingURL=dsrtoolkit_core-Js.min.js.map
